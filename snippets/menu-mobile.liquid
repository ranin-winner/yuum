<div
  x-data="menuMobile"
  class="b-header__mobile-menu"
  @resize.debounce.window="handleResize">

  <button
    @click="toggleMobileMenu"
    type="button"
    class="b-header__mobile-trigger"
    aria-label="Toggle mobile menu"
    :aria-expanded="isOpened">
    <svg class="b-header__mobile-icon" width="20" height="16" viewBox="0 0 20 16" fill="none">
      <path d="M0 1H20M0 8H20M0 15H20" stroke="currentColor" stroke-width="2"/>
    </svg>
  </button>

  <div
    class="b-header__mobile-panel"
    x-cloak
    x-show="isOpened"
    @click.away="closeMobileMenu"
    @keyup.escape.window="closeMobileMenu"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="-translate-x-full"
    x-transition:enter-end="translate-x-0"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="translate-x-0"
    x-transition:leave-end="-translate-x-full"
    role="dialog"
    aria-modal="true"
    aria-label="Mobile menu">

    <div class="b-header__mobile-header">
      <div class="b-header__mobile-spacer"></div>
      <div class="b-header__mobile-logo">
        <!-- Logo placeholder -->
      </div>
      <button
        @click="closeMobileMenu"
        class="b-header__mobile-close"
        aria-label="Close menu">
        <svg class="b-header__mobile-close-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <div class="b-header__mobile-content">
      <nav class="b-header__mobile-nav">
        <ul class="b-header__mobile-list">
          {% for link in menuItems %}
            <li class="b-header__mobile-item">
              {% if link.links.size > 0 %}
                <div x-data="{ isOpen: false }" class="b-header__mobile-dropdown">
                  <button
                    @click="isOpen = !isOpen"
                    class="b-header__mobile-dropdown-trigger"
                    :aria-expanded="isOpen.toString()">
                    <span class="b-header__mobile-text">{{ link.title }}</span>
                    <svg
                      class="b-header__mobile-chevron"
                      :class="{ 'b-header__mobile-chevron--open': isOpen }"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                  </button>

                  <div x-show="isOpen" x-collapse class="b-header__mobile-dropdown-content">
                    <ul class="b-header__mobile-sublist">
                      {% for child_link in link.links %}
                        <li class="b-header__mobile-subitem">
                          <a href="{{ child_link.url }}" class="b-header__mobile-sublink">
                            {{ child_link.title }}
                          </a>
                        </li>
                      {% endfor %}
                    </ul>
                  </div>
                </div>
              {% else %}
                <a href="{{ link.url }}" class="b-header__mobile-link">
                  {{ link.title }}
                </a>
              {% endif %}
            </li>
          {% endfor %}

          <!-- CONTACT US section -->
          <li class="b-header__mobile-item">
            <div class="b-header__mobile-contact">
              <h4 class="b-header__mobile-contact-title">CONTACT US</h4>
              <div class="b-header__mobile-contact-info">
                <a href="tel:+447000000000" class="b-header__mobile-phone">+44 7000 000000</a>
                <a href="mailto:hello@yuum.co.uk" class="b-header__mobile-email">hello@yuum.co.uk</a>
                <a href="https://wa.me/447000000000" class="b-header__mobile-whatsapp">
                  WhatsApp
                </a>
              </div>
            </div>
          </li>
        </ul>

        <div class="b-header__mobile-social">
          <a href="#" class="b-header__mobile-social-link" aria-label="Facebook">
            <svg class="b-header__mobile-social-icon" viewBox="0 0 24 24" fill="currentColor">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </a>

          <a href="#" class="b-header__mobile-social-link" aria-label="Instagram">
            <svg class="b-header__mobile-social-icon" viewBox="0 0 24 24" fill="currentColor">
              <path d="M21.9805 7.88005C21.9336 6.81738 21.7618 6.0868 21.5156 5.45374C21.2616 4.78176 20.8709 4.18014 20.359 3.68002C19.8589 3.1721 19.2533 2.77743 18.5891 2.52745C17.9524 2.28127 17.2257 2.10943 16.163 2.06257C15.0924 2.01175 14.7525 2 12.0371 2C9.32174 2 8.98186 2.01175 7.91521 2.05861C6.85253 2.10546 6.12195 2.27746 5.48905 2.52348C4.81692 2.77743 4.2153 3.16814 3.71517 3.68002C3.20726 4.18014 2.81274 4.78573 2.5626 5.44992C2.31643 6.0868 2.14458 6.81341 2.09773 7.87609C2.04691 8.9467 2.03516 9.28658 2.03516 12.002C2.03516 14.7173 2.04691 15.0572 2.09376 16.1239C2.14062 17.1865 2.31262 17.9171 2.55879 18.5502C2.81274 19.2221 3.20726 19.8238 3.71517 20.3239C4.2153 20.8318 4.82089 21.2265 5.48508 21.4765C6.12195 21.7226 6.84857 21.8945 7.9114 21.9413C8.97789 21.9883 9.31792 21.9999 12.0333 21.9999C14.7487 21.9999 15.0885 21.9883 16.1552 21.9413C17.2179 21.8945 17.9485 21.7226 18.5814 21.4765C19.9255 20.9568 20.9881 19.8941 21.5078 18.5502C21.7538 17.9133 21.9258 17.1865 21.9727 16.1239C22.0195 15.0572 22.0313 14.7173 22.0313 12.002C22.0313 9.28658 22.0273 8.9467 21.9805 7.88005ZM20.1794 16.0457C20.1364 17.0225 19.9723 17.5499 19.8356 17.9015C19.4995 18.7728 18.808 19.4643 17.9367 19.8004C17.5851 19.9372 17.0538 20.1012 16.0809 20.1441C15.026 20.1911 14.7096 20.2027 12.0411 20.2027C9.37256 20.2027 9.05221 20.1911 8.00113 20.1441C7.02438 20.1012 6.49693 19.9372 6.1453 19.8004C5.71172 19.6402 5.31705 19.3862 4.9967 19.0541C4.66461 18.7298 4.41065 18.3391 4.2504 17.9055C4.11366 17.5539 3.94959 17.0225 3.90671 16.0497C3.8597 14.9948 3.8481 14.6783 3.8481 12.0097C3.8481 9.34122 3.8597 9.02087 3.90671 7.96995C3.94959 6.99319 4.11366 6.46575 4.2504 6.11412C4.41065 5.68038 4.66461 5.28586 5.00067 4.96536C5.32483 4.63327 5.71553 4.37931 6.14927 4.21921C6.5009 4.08247 7.03232 3.9184 8.0051 3.87537C9.06 3.82851 9.37653 3.81676 12.0449 3.81676C14.7174 3.81676 15.0338 3.82851 16.0848 3.87537C17.0616 3.9184 17.589 4.08247 17.9407 4.21921C18.3743 4.37931 18.7689 4.63327 19.0893 4.96536C19.4214 5.28967 19.6753 5.68038 19.8356 6.11412C19.9723 6.46575 20.1364 6.99701 20.1794 7.96995C20.2263 9.02484 20.238 9.34122 20.238 12.0097C20.238 14.6783 20.2263 14.9908 20.1794 16.0457Z"/>
              <path d="M12.0362 6.86426C9.19976 6.86426 6.89844 9.16543 6.89844 12.002C6.89844 14.8385 9.19976 17.1397 12.0362 17.1397C14.8727 17.1397 17.1739 14.8385 17.1739 12.002C17.1739 9.16543 14.8727 6.86426 12.0362 6.86426ZM12.0362 15.3347C10.196 15.3347 8.70345 13.8422 8.70345 12.002C8.70345 10.1617 10.196 8.66927 12.0362 8.66927C13.8764 8.66927 15.3689 10.1617 15.3689 12.002C15.3689 13.8422 13.8764 15.3347 12.0362 15.3347Z"/>
              <path d="M18.5767 6.66097C18.5767 7.32333 18.0397 7.86039 17.3772 7.86039C16.7148 7.86039 16.1777 7.32333 16.1777 6.66097C16.1777 5.99846 16.7148 5.46155 17.3772 5.46155C18.0397 5.46155 18.5767 5.99846 18.5767 6.66097Z"/>
            </svg>
          </a>

          <a href="#" class="b-header__mobile-social-link" aria-label="TikTok">
            <svg class="b-header__mobile-social-icon" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/>
            </svg>
          </a>
        </div>
        {% comment %}
        <div class="b-header__mobile-account">
          <a href="/apps/retextion#/login" class="b-header__mobile-account-link">
            <svg class="b-header__mobile-account-icon" viewBox="0 0 16 21" fill="currentColor">
              <path d="M0 21C0 16.5817 3.58172 13 8 13C12.4183 13 16 16.5817 16 21H0ZM8 12C4.685 12 2 9.315 2 6C2 2.685 4.685 0 8 0C11.315 0 14 2.685 14 6C14 9.315 11.315 12 8 12Z"/>
            </svg>
            <span class="b-header__mobile-account-text">Account</span>
          </a>
        </div>
        {% endcomment %}
      </nav>
    </div>
  </div>
</div>
<script>
  document.addEventListener('alpine:init', () => {
    Alpine.data('menuMobile', () => ({
      isOpened: false,
      isLoading: false,

      init() {
        this.$watch('isOpened', (value) => {
          if (value) {
            document.body.classList.add('overflow-hidden');
            this.createOverlay();
          } else {
            document.body.classList.remove('overflow-hidden');
            this.removeOverlay();
          }
        });
      },

      handleResize() {
        if (window.innerWidth >= 1366) {
          this.closeMobileMenu();
        }
      },

      async toggleMobileMenu() {
        try {
          this.isLoading = true;
          this.isOpened = !this.isOpened;
        } catch (error) {
          console.error('Error toggling menu:', error);
        } finally {
          this.isLoading = false;
        }
      },

      closeMobileMenu() {
        this.isOpened = false;
      },

      createOverlay() {
        if (!document.querySelector('.mobile-menu-overlay')) {
          const overlay = document.createElement('div');
          overlay.className = 'mobile-menu-overlay';
          overlay.addEventListener('click', () => this.closeMobileMenu());
          document.body.appendChild(overlay);
        }
      },

      removeOverlay() {
        const overlay = document.querySelector('.mobile-menu-overlay');
        if (overlay) {
          overlay.remove();
        }
      }
    }));
  });
</script>
