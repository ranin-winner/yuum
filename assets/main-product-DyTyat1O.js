document.addEventListener("alpine:init",()=>{Alpine.data("productCard",(n,c)=>({sectionId:n,mainProduct:c||{},mode:null,showSubscription:!1,discount:0,regularPrice:0,discountedPrice:0,actualPrice:0,isLoading:!1,sellingPlanGroups:void 0,sellingPlanId:null,sellingPlansMap:[],selectedPlanId:null,selectedPlan:{},selectedProduct:null,quantity:1,init(){var i,s;if(!this.mainProduct||!this.mainProduct.price){console.error("mainProduct or its price is missing");return}const e=this.$el.querySelector(".tabs-product-selector");if(this.sellingPlanGroups=this.mainProduct.selling_plan_groups,((i=this.sellingPlanGroups)==null?void 0:i.length)>0){const t=this.sellingPlanGroups[0];((s=t==null?void 0:t.selling_plans)==null?void 0:s.length)>0&&(this.sellingPlanId=t.app_id,this.sellingPlansMap=t.selling_plans,this.selectedPlanId=this.sellingPlansMap[0].id,this.selectedPlan=this.sellingPlansMap.find(r=>r.id===this.selectedPlanId),this.discount=this.selectedPlan.price_adjustments[0].value)}e&&(this.tab1Selected=JSON.parse(e.getAttribute("data-tab1-selected")),this.tab2Selected=JSON.parse(e.getAttribute("data-tab2-selected")),this.mode=e.getAttribute("data-tab-selected")),this.showSubscription=this.mode==="subscribe",this.updateActualPrice()},initNewProduct(e){this.mainProduct=e,this.$nextTick(()=>{console.log("Product initialized:",this.mainProduct),this.updateActualPrice()})},formatPrice(e){return`$${e.toFixed(2)}`},updateActualPrice(){this.regularPrice=this.mainProduct.price/100,this.mode==="subscribe"&&this.discount>0?(this.discountedPrice=this.regularPrice-this.regularPrice*this.discount/100,this.actualPrice=this.discountedPrice):this.actualPrice=this.regularPrice},switchTab(e){this.mode=e,this.showSubscription=e==="subscribe",this.updateActualPrice()},addToCartPDP(e){const s={variantId:this.$el.getAttribute("data-first-variant"),quantity:e,sellingPlanId:this.selectedPlanId,properties:{}};Alpine.store("cart").addToCart(s),this.quantity=1},loadProduct(e){const i=`/products/${e}?sections=${this.sectionId}`,s=`/products/${e}.js`;fetch(i).then(t=>{if(!t.ok)throw new Error("Network response was not ok");return console.log("Product details:",t),t.json()}).then(t=>{if(!t[this.sectionId]){console.error("Product section not found");return}const r=document.createElement("div");r.innerHTML=t[this.sectionId];const o=r.querySelector("#MainProduct-"+this.sectionId);return this.$refs.productCardRef?this.$refs.productCardRef.replaceWith(o):console.error("Reference to productCardRef not found"),fetch(s)}).then(t=>{if(!t.ok)throw new Error("Failed to fetch product data");return t.json()}).then(t=>{this.initNewProduct(t),window.history.pushState({urlPath:e},"",e)}).catch(t=>{console.error("Error loading product:",t)})}}))});
//# sourceMappingURL=main-product-DyTyat1O.js.map
